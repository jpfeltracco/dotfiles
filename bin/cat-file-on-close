#!/usr/bin/env python3

import os
import sys
import time
import logging
from watchdog.observers import Observer
from watchdog.events import FileSystemEventHandler

class FileWrittenHandler(FileSystemEventHandler):
    def on_modified(self, event):
        # print(f'event type: {event.event_type}  path : {event.src_path}')
        if os.path.realpath(event.src_path) == os.path.realpath(sys.argv[1]):
            with open(event.src_path, 'r') as fin:
                print(fin.read())
                sys.exit(0)

if __name__ == "__main__":
    if len(sys.argv) != 2:
        print('Must pass in file to cat on modify')
        exit(1)
    path = os.path.dirname(os.path.realpath(sys.argv[1]))

    event_handler = FileWrittenHandler()
    observer = Observer()
    observer.schedule(event_handler, path, recursive=True)
    observer.start()
    observer.join()
